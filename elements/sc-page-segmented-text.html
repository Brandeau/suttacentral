<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-styles/paper-styles.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="menus/settings-menu.html">
<link rel="import" href="sc-toolbar.html">
<link rel="import" href="sc-segmented-text.html">

<dom-module id="sc-page-segmented-text">
<style is="custom-style">
paper-scroll-header-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      height: 100%;
}
paper-toolbar {
   background-color: var(--sc-gold-500);
  @apply(--shadow-elevation-8dp);
}
.sutta {
  text-transform: capitalize;
}

@media (max-width: 600px) {
    h1 {
      font-size: 2em;
      padding-top: 0.2em;
    };
    .subtitle {
      font-size: 1em;
    };
    .paper-header {
      height: 11em;
    };
}
paper-icon-button {
  color: white;
}

paper-dialog paper-icon-button {
  color: var(--disabled-text-color);
}
h2{
  @apply(--paper-font-headline);
  @apply(--sc-sans-font);
  margin: 0;
}
</style>
<template>
<paper-scroll-header-panel main>

<paper-toolbar>
      <span class="title"><p class="sutta">[[suttaTitle]]â€”[[suttaAuthor]]</p></span>
      <sc-toolbar  input-language="{{inputLanguage}}"></sc-toolbar>
      <paper-icon-button id="settingsbutton" icon="settings" onclick="settings.open()"></paper-icon-button>
</paper-toolbar>

  <paper-dialog id="settings" modal>
    <div class="buttons">
      <paper-icon-button icon="close" dialog-confirm autofocus></paper-icon-button>
    </div>
    <h2>Tools and Information</h2>
    <paper-dialog-scrollable>
        <settings-menu meta-area="[[suttaMeta]]"></settings-menu>
    </paper-dialog-scrollable>
  </paper-dialog>

<sc-segmented-text sutta-path="{{suttaPath}}" show-viewer="{{showViewer}}"></sc-segmented-text>

</paper-scroll-header-panel>

</template>
<script>
    Polymer({
      is: 'sc-page-segmented-text',

      properties: {
        suttaPath: String,
        inputLanguage: String,
        suttaAuthor: String,
        suttaTitle: String,
        suttaMeta: String,
        showViewer: {
          type: String,
          observer: 'messageChanged'
        }
      },
      ready: function() {
        this.addEventListener('eventFromTools', this.changeView);
      },
      changeView: function(event) {
          return (this.suttaAuthor === undefined) ? this.addTitles(event) : this.showViewer = event.detail.selectedView;
      },
      messageChanged: function(newValue, oldValue) {
          if (newValue === undefined) {this.showViewer = oldValue;}
        },
      addTitles: function(event) {
        this.suttaAuthor = event.detail.suttaauthor;
        this.suttaTitle = event.detail.suttatitle;
        this.suttaMeta = event.detail.suttameta;
      }
    });
</script>
</dom-module>
