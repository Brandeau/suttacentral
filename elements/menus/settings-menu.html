<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../bower_components/iron-icons/editor-icons.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../../bower_components/paper-toggle-button/paper-toggle-button.html">
<link rel="import" href="../../bower_components/paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../bower_components/iron-overlay-behavior/iron-overlay-backdrop.html">
<link rel="import" href="../addons/load-dictionary-lookup.html">

<dom-module id="settings-menu" attributes="selectedView">
<style is="custom-style">
:host{
    --primary-color: var(--sc-gold-500);
    --accent-color: var(--paper-green-a700);
  }
.paper-dialogue-container {
	max-width:40em;
}

h1,h2,h3 {
    margin: 0
}
iron-icon, paper-icon-button{
  color: var(--disabled-text-color);
}
#settingsbutton {
  color: white;
}
a {
  text-decoration: none;
  @apply(--accent-color);
}

.dialogue-section{
  margin-top:36px;
}
h3{
  @apply(--paper-font-title);
  font-family: 'Skolar Sans PE', sans-serif;
}
.nerdy-row{
  @apply(--paper-font-body2);
  color: var(--secondary-text-color);
  font-family: 'Skolar Sans PE', sans-serif;
}
paper-item iron-icon {
    margin-right: 4px;
}
paper-dropdown-menu, paper-listbox {
	width: 200px;
}
paper-toggle-button{
  margin-top:8px;
}
@media screen and (max-width: 769px) {
    #sides {
        display:none;
    }
}
</style>
<template>
{{enableViews}}
  <div class="paper-dialogue-container">
      <div class="dialogue-section">
      	<h3>View textual information</h3>
      	<div class="nerdy-row">Displays information such as volume/page references, variant readings, etc.</div>
      	<paper-toggle-button noink active="{{textualInfoEnabled}}"></paper-toggle-button>
      </div>

      <div class="dialogue-section">
      	<h3>View original text with translation</h3>
      	<div class="nerdy-row">This only works with certain texts, which include translations by Sujato and Brahmali.</div>
                <paper-radio-group selected="{{radioSelected}}">
                   	<paper-radio-button name="none">None</paper-radio-button>
                    	<paper-radio-button id="sides" name="sidebyside"><iron-icon icon="view-column"></iron-icon> Side by side</paper-radio-button>
                    	<paper-radio-button name="linebyline"><iron-icon icon="view-headline" ></iron-icon> Line by line</paper-radio-button>
                    	<paper-radio-button name="popup"><iron-icon icon="editor:insert-comment"></iron-icon> Pop-up</paper-radio-button>
                </paper-radio-group>
      </div>

      <div class="dialogue-section">
	      <h3>Activate Pali word lookup</h3>
	      <div class="nerdy-row">Analyzes the Pali text and attempts to display the word meaning. Note that this  is an aid only, and is not always accurate. Word meanings are from the New Concise Pali English Dictionary.</div>
	      <paper-dropdown-menu label="Lookup">
	        <paper-listbox class="dropdown-content" selected="{{paliLookupSelected}}">
                  <template is="dom-repeat" items="{{paliLookupArray}}" as="dictlanguage">
	               <paper-item>{{dictlanguage.language}}</paper-item>
                  </template>
	        </paper-listbox>
	      </paper-dropdown-menu>
              <template is="dom-if" if="{{_dictionaryLookup(paliLookupSelected)}}">
                  <load-dictionary-lookup input-dictionary="[[_getDictionary(paliLookupArray,paliLookupSelected)]]"></load-dictionary-lookup>
              </template>
      </div>

      <div class="dialogue-section">
	      <h3>Activate Chinese word lookup</h3>
	      <div class="nerdy-row">This enables word lookup for ancient Chinese texts. Word meanings are from the Digital Dictionary of Buddhism.</div>
	      <paper-dropdown-menu label="Lookup">
	        <paper-listbox class="dropdown-content" selected="{{chineseLookupSelected}}">
                  <template is="dom-repeat" items="{{chineseLookupArray}}" as="dictlanguage">
                        <paper-item>{{dictlanguage.language}}</paper-item>
                  </template>
	        </paper-listbox>
	      </paper-dropdown-menu>
              <template is="dom-if" if="{{_dictionaryLookup(chineseLookupSelected)}}">
                  <load-dictionary-lookup input-dictionary="[[_getDictionary(chineseLookupArray,chineseLookupSelected)]]"></load-dictionary-lookup>
              </template>
      </div>

      <div class="dialogue-section">
	      <h3>Change the script of the Pali text</h3>
	      <div class="nerdy-row">This enables you to read the Pali text in various scripts.</div>
	      <paper-dropdown-menu label="Script">
	        <paper-listbox class="dropdown-content" selected="0">
	          <paper-item>Latin</paper-item>
	          <paper-item>සිංහල</paper-item>
	          <paper-item>ไทย</paper-item>
	          <paper-item>नागरी</paper-item>
	        </paper-listbox>
	      </paper-dropdown-menu>
      </div>

      <div class="dialogue-section">
      	<h3>Remember what I have selected on this page</h3>
      	<paper-toggle-button></paper-toggle-button>
      </div>

      <div class="dialogue-section">
      	<h3>View parallels and references for this sutta <paper-icon-button icon="open-in-new"></paper-icon-button></h3>
      </div>

      <div class="dialogue-section">
	      <h3>Publication details</h3>
	      <div inner-h-t-m-l="{{metaArea}}"></div>
      </div>
    </div>

</template>
<script>
    Polymer({
      is: 'settings-menu',
      properties: {
                metaArea: Object,
                disableViews:  {
                  type: Boolean,
                  notify: true,
                  value: function(){return []},
                  observer: "_disableRadioGroup"
                },
                radioSelected: {
                    type: String,
                    value: "none",
                    observer: '_radioGroupChanged'
                },
                paliLookupArray: {
                  type: Array,
                  value: [{
                                "dict": "none",
                                "language": "None"
                              },
                              {
                                "dict": "pi2en",
                                "language": "Pali → English"
                              },
                              {
                                "dict": "pi2es",
                                "language": "Pali → Spanish"
                              }]
                },
                 paliLookupSelected: {
                    type: Number,
                    value: 0,
                },
                chineseLookupArray: {
                  type: Array,
                  value: [{
                                "dict": "none",
                                "language": "None"
                              },
                              {
                                "dict": "lzh2en",
                                "language": "Chinese → English"
                              }]
                },
                 chineseLookupSelected: {
                    type: Number,
                    value: 0,
                },
                textualInfoEnabled: {
                  type: Boolean,
                  value: false,
                  observer: "_getReferences"
                }
      },
      _getReferences: function(textualInfoEnabled) {
        var infotext = Array.from(document.querySelectorAll('body'));
        for (var i=0; i<infotext.length; i++) {
            if (textualInfoEnabled === false) {
                infotext[i].classList.remove('infomode');
            } else {
                infotext[i].classList.add('infomode');
            }
        }
      },
      _radioGroupChanged: function() {
        this.fire('eventFromChild',{selectedView:this.radioSelected});
      },
      _dictionaryLookup: function(valueSelected) {
        return (valueSelected > 0) ? true : false;
      },
      _getDictionary: function(valueArray,valueSelected) {
        return valueArray[valueSelected].dict;
      },
      _disableRadioGroup: function(disableViews) {
        if (disableViews === true) {
          var refs = this.querySelectorAll("paper-radio-button");
           for (var i=0; i<refs.length; i++) {
            refs[i].setAttribute("disabled",true);
           }
        }
      }
    });
</script>