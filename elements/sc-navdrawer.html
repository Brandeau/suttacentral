<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="paper-tree-sc/paper-tree.html">
<link rel="import" href="../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="page-selector.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">

<dom-module id="sc-navdrawer">
<style is="custom-style">
: host {
  background-color: grey;
}
paper-tree {
  @apply(--sc-sans-font);
}

#container {
  padding-top:1em;
}

#wheel {
  color: white;
  font-size: 45px;
  display: inline-block;
  vertical-align: middle;
  @apply(--sc-serif-font);
}

#hometitle {
  @apply(--sc-serif-font);
  @apply(--sc-mixed-small-caps);
  font-size: 24px;
  font-weight: normal;
  color: var(--paper-indigo-500);
  background-color: var(--paper-amber-400);
  border-bottom: 4px solid var(--paper-deep-orange-900);
  margin: 0;
  padding:  0 0 0 16px;
  white-space: nowrap;
  height:60px;
  line-height: 1.4;
}

#hometitle a {
  color: var(--paper-indigo-500);
  text-decoration: none;
}
#drawerbox {
  @apply(--shadow-elevation-16dp);
  overflow: auto;
}
#drawertoggle {
  margin: 12px 16px 16px 16px;
  z-index: 1;
  color: white;
}
</style>
<template>

<app-location route="{{route}}"></app-location>

<app-route route="{{route}}"
           pattern="/:category"
           data="{{categoryData}}"
           tail="{{categoryTail}}"></app-route>

<iron-ajax
      auto
      url="../data/menu/discoursetree.json"
      handle-as="json"
      last-response="{{navList}}"></iron-ajax>

<paper-drawer-panel drawerFocusSelector="" selected="{{selectPanel}}">
  <div drawer id="drawerbox"> 
      <div id="hometitle">
        <iron-selector selected="{{categoryData.category}}" attr-for-selected="data-page"></iron-selector>
            <a data-page="home" href="/home"><div id="wheel">â˜¸</div>&nbsp;SuttaCentral</a>
      </div>


    <div id="container">
        <paper-tree data='{{navList}}'></paper-tree>
        <paper-tree data='{
            "name": "<b>Monastic Code</b>"
        }'></paper-tree>
        <paper-tree data='{
            "name": "<b>Abhidhamma</b>"
        }'></paper-tree>

    </div>
  </div>

  <div main>
    <paper-icon-button id="drawertoggle" icon="menu" paper-drawer-toggle></paper-icon-button>
    <page-selector category="{{categoryData.category}}" route="{{categoryTail}}" input-language="{{inputLanguage}}"></page-selector>
  </div>
</paper-drawer-panel>

</template>
<script>
    Polymer({
      is: 'sc-navdrawer',

      properties: {
          selectPanel: String,
          inputLanguage: String
      },


        observers: [
        '_updateScroll(route)',
        'hideToggle(selectPanel)'
      ],

      attached: function() {
        if (!this.route.path) {
          this.set('route.path', '/home');
        }
      },

      _updateScroll: function() {
        window.scroll(0, 0);
      },
      ready: function() {
        this.addEventListener('languageSelection',this.changeLanguage);
      },
      changeLanguage: function(event) {
        return this.inputLanguage = event.detail.Language;
      },
      hideToggle: function() {
        var self = this;
        if (self.$$('paper-drawer-panel').selected == 'drawer') {
            self.toggleAttribute('hidden', true, self.$.drawertoggle);
        } else {
            setTimeout(function() {
              self.toggleAttribute('hidden', false, self.$.drawertoggle);
            }, 200);
       }
      }

    });
</script>
</dom-module>