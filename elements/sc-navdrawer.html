<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="paper-tree-sc/paper-tree.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="page-selector.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/app-route/app-location.html">

<link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">

<dom-module id="sc-navdrawer">
<template>
<style is="custom-style">
: host {
  background-color: grey;
}
paper-tree {
  @apply(--sc-sans-font);
}

#container {
  padding-top:1em;
}

#wheel {
  color: white;
  font-size: 45px;
  display: inline-block;
  vertical-align: middle;
  @apply(--sc-serif-font);
}

#hometitle {
  @apply(--sc-serif-font);
  @apply(--sc-mixed-small-caps);
  font-size: 24px;
  font-weight: normal;
  color: var(--paper-indigo-500);
  background-color: var(--paper-amber-400);
  border-bottom: 4px solid var(--paper-deep-orange-900);
  margin: 0;
  padding:  0 0 0 16px;
  white-space: nowrap;
  height:60px;
  line-height: 1.4;
}

#hometitle a {
  color: var(--paper-indigo-500);
  text-decoration: none;
}
#drawerbox {
  @apply(--shadow-elevation-16dp);
  overflow: auto;
  height: 100%;
  overflow: auto;
}
</style>
<app-location route={{route}} query-params="{{queryParams}}"></app-location>

<app-route route="{{route}}"
           pattern="/:collection"
           data="{{collectionData}}"
           tail="{{collectionTail}}"></app-route>

<app-route route="{{collectionTail}}"
           pattern="/:author"
           data="{{authorData}}"
           active="{{suttaPath}}"></app-route>

<iron-ajax
      auto
      url="../data/menu/discoursetree.json"
      handle-as="json"
      last-response="{{navList}}"></iron-ajax>

  <app-drawer-layout fullbleed responsive-width="840px">

    <app-drawer slot="drawer">
        <div id="drawerbox"> 
            <div id="hometitle">
                  <a href="/home"><div id="wheel">â˜¸</div>&nbsp;SuttaCentral</a>
            </div>
          <div id="container">
              <paper-tree data='{{navList}}'></paper-tree>
              <paper-tree data='{
                  "name": "<b>Monastic Code</b>"
              }'></paper-tree>
              <paper-tree data='{
                  "name": "<b>Abhidhamma</b>"
              }'></paper-tree>

          </div>
        </div>
    </app-drawer>
          <page-selector sutta-path="{{suttaPath}}" category="{{collectionData.collection}}" author="{{authorData.author}}" input-language="{{inputLanguage}}" query-params="{{queryParams}}"></page-selector>

  </app-drawer-layout>

</template>
<script>
    Polymer({
      is: 'sc-navdrawer',

      properties: {
          inputLanguage: String,
          collectionData: Object,
          collectionTail: Object,
          authorData: Object,
          suttaPath: Boolean,
          queryParams: Object
      },
        observers: [
        '_updateScroll(route)'
      ],

      _updateScroll: function() {
        window.scroll(0, 0);
      },
      ready: function() {
        this.addEventListener('languageSelection',this.changeLanguage);
        this.addEventListener('search', this.searchItem);
        this.addEventListener('toggleDrawer', this._toggleDrawer);
      },
      changeLanguage: function(event) {
        return this.inputLanguage = event.detail.Language;
      },
      searchItem: function(event) {
        alert("Searching for: "+ event.detail);
      },
      _toggleDrawer: function(event) {
        return this.$$('app-drawer').setAttribute("opened",event.detail.togdraw);
      }

    });
</script>
</dom-module>