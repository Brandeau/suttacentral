<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../bower_components/app-localize-behavior/app-localize-behavior.html">

<link rel="import" href="../styles/static-styles.html">

<dom-module id="sc-offline-page">
  <template>
    <style include="static-styles">

      .button {
        @apply --sc-skolar-font-size-s;
        background-color: var(--sc-primary-accent-color);
        color: var(--sc-tertiary-text-color);
        font-weight: bold;
        text-align: center;
        margin: var(--sc-size-lg);
      }

      .button-container {
        display: flex;
        flex-direction: row;
        justify-content: flex-end;
      }

      .section {
        margin: var(--sc-size-md) 0;
      }

      .icon {
        margin: var(--sc-size-sm);
      }

      .success-icon {
        color: var(--sc-toast-success-color);
      }

      .failure-icon {
        color: var(--sc-toast-error-color);
      }

    </style>

    <div id="page-wrap">
      <main>
        <section>
          <article>
            <h1>Using SuttaCentral offline</h1>
            <p>SuttaCentral is a <a href="https://developers.google.com/web/progressive-web-apps/" target="_blank">Progressive
              Web App</a>. On supported devices, many features, including navigation and previously visited pages, will
              continue to work even if you have no internet connection.</p>
            <p>In addition, you can download texts in languages of your choosing and read them when offline. This is
              especially useful for users on mobiles with limited data, or in regions with poor coverage. If your data
              is limited, we recommend connecting to wifi before downloading.</p>
            <p>PWAs are a new technology. For now, offline usage has some limitations:</p>
            <ul>
              <li>Suttas only, not Vinaya or Abhidhamma.</li>
              <li>Only one language.</li>
              <li>No original texts.</li>
              <li>Certain functions, including search, require internet connection.</li>
            </ul>

            <p>
              <template is="dom-if" if="[[browserSupportsPWA]]">
                <span>Your browser supports Progressive Web Apps!</span>
                <iron-icon icon="icons:check-box" class="icon success-icon"></iron-icon>
              </template>
              <template is="dom-if" if="[[!browserSupportsPWA]]">
                <span>Your browser does not support Progressive Web Apps.</span>
                <iron-icon icon="icons:error" class="icon failure-icon"></iron-icon>
                <br>
                <a href="https://caniuse.com/#feat=serviceworkers">
                  Here is a list of supported browsers.
                </a>
              </template>
            </p>

            <div class="button-container">
              <paper-button raised class="button">Make available offline</paper-button>
            </div>
          </article>
        </section>
      </main>
    </div>
  </template>

  <script>
      class SCOfflinePage extends SCStaticPage {
          static get is() {
              return 'sc-offline-page';
          }

          static get properties() {
              return {
                  localizedStringPath: {
                      type: String,
                      value: '/localization/elements/sc-offline-page/'
                  },
                  browserSupportsPWA: {
                      type: Boolean,
                      computed: '_doesBrowserSupportPWA()'
                  }
              }
          }

          _doesBrowserSupportPWA() {
              return ('serviceWorker' in navigator);
          }
      }

      customElements.define(SCOfflinePage.is, SCOfflinePage);
  </script>
</dom-module>